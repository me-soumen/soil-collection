<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Add or Update State</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { display: block; margin: 10px 0; padding: 8px; width: 300px; }
    .msg { margin-top: 15px; color: green; }
    a { display: inline-block; margin-top: 20px; }
  </style>
</head>
<body>

  <h1>Add or Update State</h1>

  <input type="text" id="code" placeholder="State Code">
  <input type="text" id="state" placeholder="State Name">
  <input type="text" id="place" placeholder="Place">
  <input type="date" id="date">
  <input type="time" id="time">
  <input type="number" id="latitude" placeholder="Latitude" step="any">
  <input type="number" id="longitude" placeholder="Longitude" step="any">
  <input type="text" id="notes" placeholder="Some Notes">
  <input type="text" id="token" placeholder="Github API Token">

  <button onclick="addOrUpdate()">Add or Update</button>

  <div class="msg" id="msg"></div>

  <a href="../index.html">Go Back to State Details</a>

  <script src="../js/github_api.js"></script>
  <script>
    async function addOrUpdate() {
      const code = document.getElementById('code').value.trim();
      const state = document.getElementById('state').value.trim();
      const place = document.getElementById('place').value.trim();
      const date = document.getElementById('date').value;
      const time = document.getElementById('time').value;
      const latitude = parseFloat(document.getElementById('latitude').value);
      const longitude = parseFloat(document.getElementById('longitude').value);
      const notes = document.getElementById('notes').value;

      const token = document.getElementById('token').value;

      if (!code || !state || !place || !date || isNaN(latitude) || isNaN(longitude)) {
        alert('Please fill out all fields correctly.');
        return;
      }

      // Convert to JSON object
      const jsonData = {
        code: code,
        state: state,
        place: place,
        date: date,
        time: time,
        latitude: latitude,
        longitude: longitude,
        notes: notes
      };

      updateStatesJson(JSON.stringify(jsonData, null, 2), token);
    }
  </script>

</body>
</html>
